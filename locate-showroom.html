<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Locate Toyota Showroom in Petaling Jaya & Shah Alam. Find our Toyota dealership locations, contact details, and directions. Visit Jensen for Toyota sales in PJ & SA.">
    <link rel="canonical" href="https://toyotapj.com/locate-showroom.html">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Locate Toyota Showroom | Petaling Jaya & Shah Alam | Jensen">
    <meta property="og:description" content="Find Toyota showroom locations in Petaling Jaya and Shah Alam. Visit Jensen for Toyota sales, test drives, and consultations.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://toyotapj.com/locate-showroom.html">
    <meta property="og:image" content="https://toyotapj.com/asset/og/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Locate Toyota Showroom | Petaling Jaya & Shah Alam | Jensen">
    <meta name="twitter:description" content="Find Toyota showroom locations in Petaling Jaya and Shah Alam. Visit Jensen for Toyota sales and test drives.">
    <meta name="twitter:image" content="https://toyotapj.com/asset/og/og-image.jpg">
    <title>Locate Toyota Showroom | Petaling Jaya & Shah Alam | Jensen</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="192x192" href="asset/brandmark/toyotaicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="asset/brandmark/toyotaicon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="asset/brandmark/toyotaicon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="asset/brandmark/toyotaicon.png">
    <link rel="shortcut icon" type="image/png" href="asset/brandmark/toyotaicon.png">
    <meta name="msapplication-TileImage" content="asset/brandmark/toyotaicon.png">
    
    <link rel="preload" href="styles.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="styles.css"></noscript>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <!-- Left Side - Logo and Tagline -->
                <div class="logo-section">
                    <div class="toyota-logo">
                        <img src="asset/brandmark/toyotamoveyourworld.png" alt="Toyota - Move your world" class="toyota-logo-img">
                    </div>
                </div>

                <!-- Right Side - Navigation -->
                <div class="nav-section">
                    <!-- Top Navigation Row -->
                    <div class="top-nav">
                        <a href="https://wa.me/60102700990" class="nav-link">Speak to Sales Advisor</a>
                        <a href="#" class="nav-link">Download Brochure</a>
                        <a href="#" class="nav-link external">
                            Book Your Toyota
                            <i class="fas fa-external-link-alt"></i>
                        </a>
                        <a href="locate-showroom.html" class="nav-link active">Locate Showroom</a>
                        <a href="https://wa.me/60102700990" class="nav-link whatsapp-nav">
                            <i class="fab fa-whatsapp"></i>
                            Contact 010-2700990
                        </a>
                    </div>

                    <!-- Bottom Navigation Row -->
                    <div class="main-nav">
                        <a href="index.html#models" class="nav-link dropdown">
                            Models
                            <i class="fas fa-chevron-down"></i>
                        </a>
                        <a href="#" class="nav-link dropdown">
                            Price & Model Tools
                            <i class="fas fa-chevron-down"></i>
                        </a>
                        <a href="promotions.html" class="nav-link">Promotions</a>
                        <a href="#" class="search-link">
                            <i class="fas fa-search"></i>
                        </a>
                    </div>
                </div>

                <!-- Mobile Menu Toggle -->
                <div class="mobile-toggle">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="showroom-hero">
        <div class="container">
            <div class="hero-content">
                <h1>Find Our Toyota Showrooms</h1>
                <p>Visit us at our convenient locations in Petaling Jaya and Shah Alam for the best Toyota experience</p>
            </div>
        </div>
    </section>

    <!-- Interactive Map Section -->
    <section class="map-section">
        <div class="container">
            <h2>Find Our Showrooms</h2>
            <p class="map-description">Click on the markers to get detailed information about each showroom location</p>
            
            <!-- Map Container -->
            <div class="map-container">
                <!-- Google Maps Integration -->
                <div class="neighborhood-discovery">
                    <div class="places-panel panel no-scroll">
                        <header class="navbar">
                            <div class="search-input">
                                <input class="place-search-input" placeholder="Search nearby places">
                                <button class="place-search-button">
                                    <img src="https://fonts.gstatic.com/s/i/googlematerialicons/search/v11/24px.svg" alt="search"/>
                                </button>
                            </div>
                        </header>
                        <div class="results">
                            <ul class="place-results-list"></ul>
                        </div>
                        <button class="show-more-button sticky">
                            <span>Show More</span>
                            <img class="right" src="https://fonts.gstatic.com/s/i/googlematerialicons/expand_more/v11/24px.svg" alt="expand"/>
                        </button>
                    </div>
                    <div class="details-panel panel"></div>
                    <div class="map"></div>
                    <div class="photo-modal">
                        <img alt="place photo"/>
                        <div>
                            <button class="back-button">
                                <img class="icon" src="https://fonts.gstatic.com/s/i/googlematerialicons/arrow_back/v11/24px.svg" alt="back"/>
                            </button>
                            <div class="photo-text">
                                <div class="photo-place"></div>
                                <div class="photo-attrs">Photo by <span></span></div>
                            </div>
                        </div>
                    </div>
                    <svg class="marker-pin" xmlns="http://www.w3.org/2000/svg" width="26" height="38" fill="none">
                        <path d="M13 0C5.817 0 0 5.93 0 13.267c0 7.862 5.59 10.81 9.555 17.624C12.09 35.248 11.342 38 13 38c1.723 0 .975-2.817 3.445-7.043C20.085 24.503 26 21.162 26 13.267 26 5.93 20.183 0 13 0Z"/>
                    </svg>
                </div>
            </div>
        </div>
    </section>

    <!-- Showroom Locations Cards -->
    <section class="showroom-locations">
        <div class="container">
            <h2>Our Showroom Locations</h2>
            <div class="locations-grid">
                <!-- Petaling Jaya Location -->
                <div class="location-card">
                    <div class="location-image">
                        <img src="asset/carousel/home-page-banner-desktop.jpg" alt="Toyota Showroom Petaling Jaya">
                        <div class="location-badge">PJ</div>
                    </div>
                    <div class="location-content">
                        <h3>Petaling Jaya Showroom</h3>
                        <div class="location-details">
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <div>
                                    <strong>Address:</strong>
                                    <p>Petaling Jaya, Selangor<br>Malaysia</p>
                                </div>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <div>
                                    <strong>Business Hours:</strong>
                                    <p>Monday - Saturday: 9:00 AM - 6:00 PM<br>Sunday: Closed</p>
                                </div>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-phone"></i>
                                <div>
                                    <strong>Contact:</strong>
                                    <p><a href="tel:+60102700990">010-270-0990</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="location-actions">
                            <a href="https://maps.google.com/?q=Petaling+Jaya+Selangor" target="_blank" class="btn-primary">
                                <i class="fas fa-directions"></i>
                                Get Directions
                            </a>
                            <a href="https://wa.me/60102700990" class="btn-secondary">
                                <i class="fab fa-whatsapp"></i>
                                WhatsApp Us
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Shah Alam Location -->
                <div class="location-card">
                    <div class="location-image">
                        <img src="asset/carousel/HomepageBanner_Desktop_v3.jpg" alt="Toyota Showroom Shah Alam">
                        <div class="location-badge">SA</div>
                    </div>
                    <div class="location-content">
                        <h3>Shah Alam Showroom</h3>
                        <div class="location-details">
                            <div class="detail-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <div>
                                    <strong>Address:</strong>
                                    <p>Shah Alam, Selangor<br>Malaysia</p>
                                </div>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-clock"></i>
                                <div>
                                    <strong>Business Hours:</strong>
                                    <p>Monday - Saturday: 9:00 AM - 6:00 PM<br>Sunday: Closed</p>
                                </div>
                            </div>
                            <div class="detail-item">
                                <i class="fas fa-phone"></i>
                                <div>
                                    <strong>Contact:</strong>
                                    <p><a href="tel:+60102700990">010-270-0990</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="location-actions">
                            <a href="https://maps.google.com/?q=Shah+Alam+Selangor" target="_blank" class="btn-primary">
                                <i class="fas fa-directions"></i>
                                Get Directions
                            </a>
                            <a href="https://wa.me/60102700990" class="btn-secondary">
                                <i class="fab fa-whatsapp"></i>
                                WhatsApp Us
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Services Section -->
    <section class="showroom-services">
        <div class="container">
            <h2>What You Can Do at Our Showrooms</h2>
            <div class="services-grid">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-car"></i>
                    </div>
                    <h3>Test Drive</h3>
                    <p>Experience Toyota vehicles firsthand with our personalized test drive service</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <h3>Personal Consultation</h3>
                    <p>Get expert advice from Jensen on the perfect Toyota model for your needs</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>Financing Options</h3>
                    <p>Explore flexible financing solutions with our banking partners</p>
                </div>
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <h3>Complete Purchase</h3>
                    <p>Complete your Toyota purchase with our streamlined process</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact CTA -->
    <section class="contact-cta">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to Visit Our Showroom?</h2>
                <p>Book your appointment with Jensen for a personalized Toyota experience</p>
                <div class="cta-buttons">
                    <a href="https://wa.me/60102700990" class="btn-primary">
                        <i class="fab fa-whatsapp"></i>
                        Book Appointment
                    </a>
                    <a href="tel:+60102700990" class="btn-secondary">
                        <i class="fas fa-phone"></i>
                        Call Now
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p>toyotapj.com â€“ UMW Toyotsu Motors Sales Advisor.</p>
                <p><strong>Not affiliated with Toyota.</strong></p>
            </div>
        </div>
    </footer>

    <!-- Google Maps Integration Scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/handlebars/4.7.7/handlebars.min.js"></script>
    <script>
      'use strict';

      /** Hides a DOM element and optionally focuses on focusEl. */
      function hideElement(el, focusEl) {
        el.style.display = 'none';
        if (focusEl) focusEl.focus();
      }

      /** Shows a DOM element that has been hidden and optionally focuses on focusEl. */
      function showElement(el, focusEl) {
        el.style.display = 'block';
        if (focusEl) focusEl.focus();
      }

      /** Determines if a DOM element contains content that cannot be scrolled into view. */
      function hasHiddenContent(el) {
        const noscroll = window.getComputedStyle(el).overflowY.includes('hidden');
        return noscroll && el.scrollHeight > el.clientHeight;
      }

      /** Format a Place Type string by capitalizing and replacing underscores with spaces. */
      function formatPlaceType(str) {
        const capitalized = str.charAt(0).toUpperCase() + str.slice(1);
        return capitalized.replace(/_/g, ' ');
      }

      /** Initializes an array of zeros with the given size. */
      function initArray(arraySize) {
        const array = [];
        while (array.length < arraySize) {
          array.push(0);
        }
        return array;
      }

      /** Assigns star icons to an object given its rating (out of 5). */
      function addStarIcons(obj) {
        if (!obj.rating) return;
        const starsOutOfTen = Math.round(2 * obj.rating);
        const fullStars = Math.floor(starsOutOfTen / 2);
        const halfStars = fullStars !== starsOutOfTen / 2 ? 1 : 0;
        const emptyStars = 5 - fullStars - halfStars;

        // Express stars as arrays to make iterating in Handlebars easy.
        obj.fullStarIcons = initArray(fullStars);
        obj.halfStarIcons = initArray(halfStars);
        obj.emptyStarIcons = initArray(emptyStars);
      }

      /**
       * Constructs an array of opening hours by day from a PlaceOpeningHours object,
       * where adjacent days of week with the same hours are collapsed into one element.
       */
      function parseDaysHours(openingHours) {
        const daysHours = openingHours.weekday_text.map((e) => e.split(/\:\s+/))
                  .map((e) => ({'days': e[0].substr(0, 3), 'hours': e[1]}));

        for (let i = 1; i < daysHours.length; i++) {
          if (daysHours[i - 1].hours === daysHours[i].hours) {
            if (daysHours[i - 1].days.indexOf('-') !== -1) {
              daysHours[i - 1].days =
                  daysHours[i - 1].days.replace(/\w+$/, daysHours[i].days);
            } else {
              daysHours[i - 1].days += ' - ' + daysHours[i].days;
            }
            daysHours.splice(i--, 1);
          }
        }
        return daysHours;
      }

      /** Number of POIs to show on widget load. */
      const ND_NUM_PLACES_INITIAL = 5;

      /** Number of additional POIs to show when 'Show More' button is clicked. */
      const ND_NUM_PLACES_SHOW_MORE = 5;

      /** Maximum number of place photos to show on the details panel. */
      const ND_NUM_PLACE_PHOTOS_MAX = 6;

      /** Minimum zoom level at which the default map POI pins will be shown. */
      const ND_DEFAULT_POI_MIN_ZOOM = 18;

      /** Mapping of Place Types to Material Icons used to render custom map markers. */
      const ND_MARKER_ICONS_BY_TYPE = {
        // Full list of icons can be found at https://fonts.google.com/icons
        '_default': 'circle',
      };

      /**
       * Defines an instance of the Neighborhood Discovery widget, to be
       * instantiated when the Maps library is loaded.
       */
      function NeighborhoodDiscovery(configuration) {
        const widget = this;
        const widgetEl = document.querySelector('.neighborhood-discovery');

        widget.center = configuration.mapOptions.center;
        widget.places = configuration.pois || [];

        // Initialize core functionalities -------------------------------------

        initializeMap();
        initializePlaceDetails();
        initializeSidePanel();

        // Initialize additional capabilities ----------------------------------

        initializeSearchInput();
        initializeDistanceMatrix();
        initializeDirections();

        // Initializer function definitions ------------------------------------

        /** Initializes the interactive map and adds place markers. */
        function initializeMap() {
          const mapOptions = configuration.mapOptions;
          widget.mapBounds = new google.maps.Circle(
            {center: widget.center, radius: configuration.mapRadius}).getBounds();
          mapOptions.restriction = {latLngBounds: widget.mapBounds};
          mapOptions.mapTypeControlOptions = {position: google.maps.ControlPosition.TOP_RIGHT};
          widget.map = new google.maps.Map(widgetEl.querySelector('.map'), mapOptions);
          widget.map.fitBounds(widget.mapBounds, /* padding= */ 0);
          widget.map.addListener('click', (e) => {
            // Check if user clicks on a POI pin from the base map.
            if (e.placeId) {
              e.stop();
              widget.selectPlaceById(e.placeId);
            }
          });
          widget.map.addListener('zoom_changed', () => {
            // Customize map styling to show/hide default POI pins or text based on zoom level.
            const hideDefaultPoiPins = widget.map.getZoom() < ND_DEFAULT_POI_MIN_ZOOM;
            widget.map.setOptions({
              styles: [{
                featureType: 'poi',
                elementType: hideDefaultPoiPins ? 'labels' : 'labels.text',
                stylers: [{visibility: 'off'}],
              }],
            });
          });

          const markerPath = widgetEl.querySelector('.marker-pin path').getAttribute('d');
          const drawMarker = function(title, position, fillColor, strokeColor, labelText) {
            return new google.maps.Marker({
              title: title,
              position: position,
              map: widget.map,
              icon: {
                path: markerPath,
                fillColor: fillColor,
                fillOpacity: 1,
                strokeColor: strokeColor,
                anchor: new google.maps.Point(13, 35),
                labelOrigin: new google.maps.Point(13, 13),
              },
              label: {
                text: labelText,
                color: 'white',
                fontSize: '16px',
                fontFamily: 'Material Icons',
              },
            });
          };

          // Add marker at the center location (if specified).
          if (configuration.centerMarker && configuration.centerMarker.icon) {
            drawMarker('Home', widget.center,
                       '#1A73E8', '#185ABC', configuration.centerMarker.icon);
          }

          // Add marker for the specified Place object.
          widget.addPlaceMarker = function(place) {
            place.marker = drawMarker(place.name, place.coords, '#EA4335', '#C5221F', place.icon);
            place.marker.addListener('click', () => void widget.selectPlaceById(place.placeId));
          };

          // Fit map to bounds that contain all markers of the specified Place objects.
          widget.updateBounds = function(places) {
            const bounds = new google.maps.LatLngBounds();
            bounds.extend(widget.center);
            for (let place of places) {
              bounds.extend(place.marker.getPosition());
            }
            widget.map.fitBounds(bounds, /* padding= */ 100);
          };

          // Marker used to highlight a place from Autocomplete search.
          widget.selectedPlaceMarker = new google.maps.Marker({title: 'Point of Interest'});
        }

        /** Initializes Place Details service for the widget. */
        function initializePlaceDetails() {
          const detailsService = new google.maps.places.PlacesService(widget.map);
          const placeIdsToDetails = new Map();  // Create object to hold Place results.

          for (let place of widget.places) {
            placeIdsToDetails.set(place.placeId, place);
            place.fetchedFields = new Set(['place_id']);
          }

          widget.fetchPlaceDetails = function(placeId, fields, callback) {
            if (!placeId || !fields) return;

            // Check for field existence in Place object.
            let place = placeIdsToDetails.get(placeId);
            if (!place) {
              place = {placeId: placeId, fetchedFields: new Set(['place_id'])};
              placeIdsToDetails.set(placeId, place);
            }
            const missingFields = fields.filter((field) => !place.fetchedFields.has(field));
            if (missingFields.length === 0) {
              callback(place);
              return;
            }

            const request = {placeId: placeId, fields: missingFields};
            let retryCount = 0;
            const processResult = function(result, status) {
              if (status !== google.maps.places.PlacesServiceStatus.OK) {
                // If query limit has been reached, wait before making another call;
                // Increase wait time of each successive retry with exponential backoff
                // and terminate after five failed attempts.
                if (status === google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT &&
                    retryCount < 5) {
                  const delay = (Math.pow(2, retryCount) + Math.random()) * 500;
                  setTimeout(() => void detailsService.getDetails(request, processResult), delay);
                  retryCount++;
                }
                return;
              }

              // Basic details.
              if (result.name) place.name = result.name;
              if (result.geometry) place.coords = result.geometry.location;
              if (result.formatted_address) place.address = result.formatted_address;
              if (result.photos) {
                place.photos = result.photos.map((photo) => ({
                  urlSmall: photo.getUrl({maxWidth: 200, maxHeight: 200}),
                  urlLarge: photo.getUrl({maxWidth: 1200, maxHeight: 1200}),
                  attrs: photo.html_attributions,
                })).slice(0, ND_NUM_PLACE_PHOTOS_MAX);
              }
              if (result.types) {
                place.type = formatPlaceType(result.types[0]);
                place.icon = ND_MARKER_ICONS_BY_TYPE['_default'];
                for (let type of result.types) {
                  if (type in ND_MARKER_ICONS_BY_TYPE) {
                    place.type = formatPlaceType(type);
                    place.icon = ND_MARKER_ICONS_BY_TYPE[type];
                    break;
                  }
                }
              }
              if (result.url) place.url = result.url;

              // Contact details.
              if (result.website) {
                place.website = result.website;
                const url = new URL(place.website);
                place.websiteDomain = url.hostname;
              }
              if (result.formatted_phone_number) place.phoneNumber = result.formatted_phone_number;
              if (result.opening_hours) place.openingHours = parseDaysHours(result.opening_hours);

              // Review details.
              if (result.rating) {
                place.rating = result.rating;
                addStarIcons(place);
              }
              if (result.user_ratings_total) place.numReviews = result.user_ratings_total;
              if (result.price_level) {
                place.priceLevel = result.price_level;
                place.dollarSigns = initArray(result.price_level);
              }
              if (result.reviews) {
                place.reviews = result.reviews;
                for (let review of place.reviews) {
                  addStarIcons(review);
                }
              }

              for (let field of missingFields) {
                place.fetchedFields.add(field);
              }
              callback(place);
            };

            // Use result from Place Autocomplete if available.
            if (widget.placeIdsToAutocompleteResults) {
              const autoCompleteResult = widget.placeIdsToAutocompleteResults.get(placeId);
              if (autoCompleteResult) {
                processResult(autoCompleteResult, google.maps.places.PlacesServiceStatus.OK);
                return;
              }
            }
            detailsService.getDetails(request, processResult);
          };
        }

        /** Initializes the side panel that holds curated POI results. */
        function initializeSidePanel() {
          const placesPanelEl = widgetEl.querySelector('.places-panel');
          const detailsPanelEl = widgetEl.querySelector('.details-panel');
          const placeResultsEl = widgetEl.querySelector('.place-results-list');
          const showMoreButtonEl = widgetEl.querySelector('.show-more-button');
          const photoModalEl = widgetEl.querySelector('.photo-modal');
          const detailsTemplate = Handlebars.compile(
              document.getElementById('nd-place-details-tmpl').innerHTML);
          const resultsTemplate = Handlebars.compile(
              document.getElementById('nd-place-results-tmpl').innerHTML);

          // Show specified POI photo in a modal.
          const showPhotoModal = function(photo, placeName) {
            const prevFocusEl = document.activeElement;
            const imgEl = photoModalEl.querySelector('img');
            imgEl.src = photo.urlLarge;
            const backButtonEl = photoModalEl.querySelector('.back-button');
            backButtonEl.addEventListener('click', () => {
              hideElement(photoModalEl, prevFocusEl);
              imgEl.src = '';
            });
            photoModalEl.querySelector('.photo-place').innerHTML = placeName;
            photoModalEl.querySelector('.photo-attrs span').innerHTML = photo.attrs;
            const attributionEl = photoModalEl.querySelector('.photo-attrs a');
            if (attributionEl) attributionEl.setAttribute('target', '_blank');
            photoModalEl.addEventListener('click', (e) => {
              if (e.target === photoModalEl) {
                hideElement(photoModalEl, prevFocusEl);
                imgEl.src = '';
              }
            });
            showElement(photoModalEl, backButtonEl);
          };

          // Select a place by id and show details.
          let selectedPlaceId;
          widget.selectPlaceById = function(placeId, panToMarker) {
            if (selectedPlaceId === placeId) return;
            selectedPlaceId = placeId;
            const prevFocusEl = document.activeElement;

            const showDetailsPanel = function(place) {
              detailsPanelEl.innerHTML = detailsTemplate(place);
              const backButtonEl = detailsPanelEl.querySelector('.back-button');
              backButtonEl.addEventListener('click', () => {
                hideElement(detailsPanelEl, prevFocusEl);
                selectedPlaceId = undefined;
                widget.updateDirections();
                widget.selectedPlaceMarker.setMap(null);
              });
              detailsPanelEl.querySelectorAll('.photo').forEach((photoEl, i) => {
                photoEl.addEventListener('click', () => {
                  showPhotoModal(place.photos[i], place.name);
                });
              });
              showElement(detailsPanelEl, backButtonEl);
              detailsPanelEl.scrollTop = 0;
            };

            const processResult = function(place) {
              if (place.marker) {
                widget.selectedPlaceMarker.setMap(null);
              } else {
                widget.selectedPlaceMarker.setPosition(place.coords);
                widget.selectedPlaceMarker.setMap(widget.map);
              }
              if (panToMarker) {
                widget.map.panTo(place.coords);
              }
              showDetailsPanel(place);
              widget.fetchDuration(place, showDetailsPanel);
              widget.updateDirections(place);
            };

            widget.fetchPlaceDetails(placeId, [
              'name', 'types', 'geometry.location', 'formatted_address', 'photo', 'url',
              'website', 'formatted_phone_number', 'opening_hours',
              'rating', 'user_ratings_total', 'price_level', 'review',
            ], processResult);
          };

          // Render the specified place objects and append them to the POI list.
          const renderPlaceResults = function(places, startIndex) {
            placeResultsEl.insertAdjacentHTML('beforeend', resultsTemplate({places: places}));
            placeResultsEl.querySelectorAll('.place-result').forEach((resultEl, i) => {
              const place = places[i - startIndex];
              if (!place) return;
              // Clicking anywhere on the item selects the place.
              // Additionally, create a button element to make this behavior
              // accessible under tab navigation.
              resultEl.addEventListener('click', () => {
                widget.selectPlaceById(place.placeId, /* panToMarker= */ true);
              });
              resultEl.querySelector('.name').addEventListener('click', (e) => {
                widget.selectPlaceById(place.placeId, /* panToMarker= */ true);
                e.stopPropagation();
              });
              resultEl.querySelector('.photo').addEventListener('click', (e) => {
                showPhotoModal(place.photos[0], place.name);
                e.stopPropagation();
              });
              widget.addPlaceMarker(place);
            });
          };

          // Index of next Place object to show in the POI list.
          let nextPlaceIndex = 0;

          // Fetch and show basic info for the next N places.
          const showNextPlaces = function(n) {
            const nextPlaces = widget.places.slice(nextPlaceIndex, nextPlaceIndex + n);
            if (nextPlaces.length < 1) {
              hideElement(showMoreButtonEl);
              return;
            }
            showMoreButtonEl.disabled = true;
            // Keep track of the number of Places calls that have not finished.
            let count = nextPlaces.length;
            for (let place of nextPlaces) {
              const processResult = function(place) {
                count--;
                if (count > 0) return;
                renderPlaceResults(nextPlaces, nextPlaceIndex);
                nextPlaceIndex += n;
                widget.updateBounds(widget.places.slice(0, nextPlaceIndex));
                const hasMorePlacesToShow = nextPlaceIndex < widget.places.length;
                if (hasMorePlacesToShow || hasHiddenContent(placesPanelEl)) {
                  showElement(showMoreButtonEl);
                  showMoreButtonEl.disabled = false;
                } else {
                  hideElement(showMoreButtonEl);
                }
              };
              widget.fetchPlaceDetails(place.placeId, [
                'name', 'types', 'geometry.location',
                'photo',
                'rating', 'user_ratings_total', 'price_level',
              ], processResult);
            }
          };
          showNextPlaces(ND_NUM_PLACES_INITIAL);

          showMoreButtonEl.addEventListener('click', () => {
            placesPanelEl.classList.remove('no-scroll');
            showMoreButtonEl.classList.remove('sticky');
            showNextPlaces(ND_NUM_PLACES_SHOW_MORE);
          });
        }

        /** Initializes Search Input for the widget. */
        function initializeSearchInput() {
          const searchInputEl = widgetEl.querySelector('.place-search-input');
          widget.placeIdsToAutocompleteResults = new Map();

          // Set up Autocomplete on the search input.
          const autocomplete = new google.maps.places.Autocomplete(searchInputEl, {
            types: ['establishment'],
            fields: [
              'place_id', 'name', 'types', 'geometry.location', 'formatted_address', 'photo', 'url',
              'website', 'formatted_phone_number', 'opening_hours',
              'rating', 'user_ratings_total', 'price_level', 'review',
            ],
            bounds: widget.mapBounds,
            strictBounds: true,
          });
          autocomplete.addListener('place_changed', () => {
            const place = autocomplete.getPlace();
            widget.placeIdsToAutocompleteResults.set(place.place_id, place);
            widget.selectPlaceById(place.place_id, /* panToMarker= */ true);
            searchInputEl.value = '';
          });
        }

        /** Initializes Distance Matrix service for the widget. */
        function initializeDistanceMatrix() {
          const distanceMatrixService = new google.maps.DistanceMatrixService();

          // Annotate travel times from the centered location to the specified place.
          widget.fetchDuration = function(place, callback) {
            if (!widget.center || !place || !place.coords || place.duration) return;
            const request = {
              origins: [widget.center],
              destinations: [place.coords],
              travelMode: google.maps.TravelMode.DRIVING,
            };
            distanceMatrixService.getDistanceMatrix(request, function(result, status) {
              if (status === google.maps.DistanceMatrixStatus.OK) {
                const trip = result.rows[0].elements[0];
                if (trip.status === google.maps.DistanceMatrixElementStatus.OK) {
                  place.duration = trip.duration;
                  callback(place);
                }
              }
            });
          };
        }

        /** Initializes Directions service for the widget. */
        function initializeDirections() {
          const directionsService = new google.maps.DirectionsService();
          const directionsRenderer = new google.maps.DirectionsRenderer({
            suppressMarkers: true,
            preserveViewport: true,
          });

          // Update directions from the centered location to specified place.
          widget.updateDirections = function(place) {
            if (!widget.center || !place || !place.coords) {
              directionsRenderer.setMap(null);
              return;
            }
            // Use existing results if available.
            if (place.directions) {
              directionsRenderer.setMap(widget.map);
              directionsRenderer.setDirections(place.directions);
              return;
            }
            const request = {
              origin: widget.center,
              destination: place.coords,
              travelMode: google.maps.TravelMode.DRIVING,
            };
            directionsService.route(request, function(result, status) {
              if (status === google.maps.DirectionsStatus.OK) {
                place.directions = result;
                directionsRenderer.setMap(widget.map);
                directionsRenderer.setDirections(result);
              }
            });
          };
        }
      }

      // Configuration for the map
      const CONFIGURATION = {
        "capabilities": {"search":true,"distances":true,"directions":true,"contacts":true,"atmospheres":true,"thumbnails":true},
        "centerMarker": {"icon":"circle"},
        "mapRadius": 4000,
        "mapOptions": {"center":{"lat":3.0634499,"lng":101.5232911},"fullscreenControl":true,"mapTypeControl":true,"streetViewControl":false,"zoom":16,"zoomControl":true,"maxZoom":20,"mapId":""},
        "mapsApiKey": "AIzaSyDvqMeX2GorX54EzxpUWXbpPQihp6YjRog",
        "pois": [
          {
            "placeId": "ChIJN1t_tDeuEmsRUsoyG83frY4", // Petaling Jaya
            "name": "Toyota Showroom Petaling Jaya",
            "coords": {"lat": 3.1073, "lng": 101.6085}
          },
          {
            "placeId": "ChIJN1t_tDeuEmsRUsoyG83frY4", // Shah Alam
            "name": "Toyota Showroom Shah Alam", 
            "coords": {"lat": 3.0733, "lng": 101.5185}
          }
        ]
      };

      function initMap() {
        // Check if API key is provided
        if (!CONFIGURATION.mapsApiKey || CONFIGURATION.mapsApiKey === '') {
          console.log('Google Maps API key not provided. Showing fallback map.');
          return;
        }
        
        try {
          new NeighborhoodDiscovery(CONFIGURATION);
        } catch (error) {
          console.error('Error initializing Google Maps:', error);
        }
      }
      
      // Handle API key error
      function gm_authFailure() {
        console.log('Google Maps API key is invalid or has restrictions.');
        // The fallback map is already visible by default
      }
    </script>

    <!-- Handlebars Templates -->
    <script id="nd-place-results-tmpl" type="text/x-handlebars-template">
      {{#each places}}
        <li class="place-result">
          <div class="text">
            <button class="name">{{name}}</button>
            <div class="info">
              {{#if rating}}
                <span>{{rating}}</span>
                <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star/v15/24px.svg" alt="rating" class="star-icon"/>
              {{/if}}
              {{#if numReviews}}
                <span>&nbsp;({{numReviews}})</span>
              {{/if}}
              {{#if priceLevel}}
                &#183;&nbsp;<span>{{#each dollarSigns}}${{/each}}&nbsp;</span>
              {{/if}}
            </div>
            <div class="info">{{type}}</div>
          </div>
          <button class="photo" style="background-image:url({{photos.0.urlSmall}})" aria-label="show photo in viewer"></button>
        </li>
      {{/each}}
    </script>
    <script id="nd-place-details-tmpl" type="text/x-handlebars-template">
      <div class="navbar">
        <button class="back-button">
          <img class="icon" src="https://fonts.gstatic.com/s/i/googlematerialicons/arrow_back/v11/24px.svg" alt="back"/>
          Back
        </button>
      </div>
      <header>
        <h2>{{name}}</h2>
        <div class="info">
          {{#if rating}}
            <span class="star-rating-numeric">{{rating}}</span>
            <span>
              {{#each fullStarIcons}}
                <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star/v15/24px.svg" alt="full star" class="star-icon"/>
              {{/each}}
              {{#each halfStarIcons}}
                <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star_half/v17/24px.svg" alt="half star" class="star-icon"/>
              {{/each}}
              {{#each emptyStarIcons}}
                <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star_outline/v9/24px.svg" alt="empty star" class="star-icon"/>
              {{/each}}
            </span>
          {{/if}}
          {{#if numReviews}}
            <a href="{{url}}" target="_blank">{{numReviews}} reviews</a>
          {{else}}
            <a href="{{url}}" target="_blank">See on Google Maps</a>
          {{/if}}
          {{#if priceLevel}}
            &#183;
            <span class="price-dollars">
              {{#each dollarSigns}}${{/each}}
            </span>
          {{/if}}
        </div>
        {{#if type}}
          <div class="info">{{type}}</div>
        {{/if}}
        {{#if duration}}
          <div class="info">
            <img src="https://fonts.gstatic.com/s/i/googlematerialicons/directions_car/v11/24px.svg" alt="car travel" class="travel-icon"/>
            <span>&nbsp;{{duration.text}}</span>
          </div>
        {{/if}}
      </header>
      <div class="section">
        {{#if address}}
          <div class="contact">
            <img src="https://fonts.gstatic.com/s/i/googlematerialicons/place/v10/24px.svg" alt="Address" class="icon"/>
            <div class="text">
              {{address}}
            </div>
          </div>
        {{/if}}
        {{#if website}}
          <div class="contact">
            <img src="https://fonts.gstatic.com/s/i/googlematerialicons/public/v10/24px.svg" alt="Website" class="icon"/>
            <div class="text">
              <a href="{{website}}" target="_blank">{{websiteDomain}}</a>
            </div>
          </div>
        {{/if}}
        {{#if phoneNumber}}
          <div class="contact">
            <img src="https://fonts.gstatic.com/s/i/googlematerialicons/phone/v10/24px.svg" alt="Phone number" class="icon"/>
            <div class="text">
              {{phoneNumber}}
            </div>
          </div>
        {{/if}}
        {{#if openingHours}}
          <div class="contact">
            <img src="https://fonts.gstatic.com/s/i/googlematerialicons/schedule/v12/24px.svg" alt="Opening hours" class="icon"/>
            <div class="text">
              {{#each openingHours}}
                <div>
                  <span class="weekday">{{days}}</span>
                  <span class="hours">{{hours}}</span>
                </div>
              {{/each}}
            </div>
          </div>
        {{/if}}
      </div>
      {{#if photos}}
        <div class="photos section">
          {{#each photos}}
            <button class="photo" style="background-image:url({{urlSmall}})" aria-label="show photo in viewer"></button>
          {{/each}}
        </div>
      {{/if}}
      {{#if reviews}}
        <div class="reviews section">
          <p class="attribution">Reviews by Google users</p>
          {{#each reviews}}
            <div class="review">
              <a class="reviewer-identity" href="{{author_url}}" target="_blank">
                <div class="reviewer-avatar" style="background-image:url({{profile_photo_url}})"></div>
                <div class="reviewer-name">{{author_name}}</div>
              </a>
              <div class="rating info">
                <span>
                  {{#each fullStarIcons}}
                    <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star/v15/24px.svg" alt="full star" class="star-icon"/>
                  {{/each}}
                  {{#each halfStarIcons}}
                    <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star_half/v17/24px.svg" alt="half star" class="star-icon"/>
                  {{/each}}
                  {{#each emptyStarIcons}}
                    <img src="https://fonts.gstatic.com/s/i/googlematerialicons/star_outline/v9/24px.svg" alt="empty star" class="star-icon"/>
                  {{/each}}
                </span>
                <span class="review-time">{{relative_time_description}}</span>
              </div>
              <div class="info">{{text}}</div>
            </div>
          {{/each}}
        </div>
      {{/if}}
      {{#if html_attributions}}
        <div class="section">
          {{#each html_attributions}}
            <p class="attribution">{{{this}}}</p>
          {{/each}}
        </div>
      {{/if}}
    </script>

    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDvqMeX2GorX54EzxpUWXbpPQihp6YjRog&callback=initMap&libraries=places,geometry&solution_channel=GMP_QB_neighborhooddiscovery_v3_cABCDEF" async defer></script>
    
    <script src="script.js" defer></script>
</body>
</html>
